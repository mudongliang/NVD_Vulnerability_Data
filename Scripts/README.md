# Scripts

## Uncompress

```
./uncomp_all_josn.sh
```

## Demo to search from NVD Database

```
./interpret_json.py
```
## Demo about Linux-kernel Use-After-Free CVEs
### Demo to search kernel Use-After-Free CVEs 
All UAFs that have "CWE-416" or "CWE-415" in their "problemtype_data" or "description_data".   
```
./kernel_UAFs.py
```
### Demo to search unnormal kernel Use-After-Free CVEs
```
./unnormal-kUAF.py
```

Output Format: (cve_id+"&&&"+cwe_id+"&&&"+cve_description)

Unnormal UAFs are those do not have "CWE-416" or "CWE-415" in their "problemtype_data" and "description_data",
but their "description_data" indicates that they are UAF-related
(have "se-after-free" or "ouble-free" in their "description_data").

!!! They are possible UAFs, need to be checked manually.

For example:
>CVE-2018-18559    
>CWE-362    
>In the Linux kernel through 4.19, a use-after-free can occur due to a race condition between fanout_add from setsockopt and bind on an AF_PACKET socket. This issue exists because of the 15fe076edea787807a7cdc168df832544b58eba6 incomplete fix for a race condition. The code mishandles a certain multithreaded case involving a packet_do_bind unregister action followed by a packet_notifier register action. Later, packet_release operates on only one of the two applicable linked lists. The attacker can achieve Program Counter control.
### Demo to get all normal UAF and their product names
```
./uaf-product.py
``` 
UAFs that have "CWE-416" or "CWE-415" in their "problemtype_data" or "description_data".

return value is organized as {cveid,{vendor_name,{product_name}\*}\*}\*
## Demo about Linux-kernel CVEs
### Demo to search kernel CVEs
To get all kernel CVEs whose "vendor_data" is "linux", "product_data" is "linux_kernel".

Output Format: (CVE-id,CWE-id[]/Descrption)

```
mkdir kernel_bugs
./kennel_bugs.py
```

### Demo to search unnormal-kernel CVEs
To screen out unnormal Linux Kernel CVEs,
whose "vendor_data" is "linux", "product_data" contains but is not "linux_kernel".

Output Format: (CVE-id,Product_name,CWE-id[]/Descrption)
```
./unnormal_kernel_bugs
```
unnormal-kernel:
>CVE-2015-1142857 linux_kernel_ixgbe    
>CVE-2016-3707 linux_kernel-rt    
>CVE-2016-5343 linux_kernel-rt   

## Demo to search buffer-overflow CVEs
```
./kernel_overflow.py
```
All CVEs in ["CWE-121","CWE-122"] or having "uffer overflow" in their description,see in output file "kernel_overflow.csv".

Not guaranteed to be true overflow bugs in kernel, need to be checked manually.

We treat CVEs not in ["CWE-787","CWE-788","CWE-119","CWE-118","CWE-20","CWE-19","CWE-18","CWE-699","CWE-693","CWE-1019","CWE-1000","CWE-1008","CWE-254","CWE-975"](buffer overflow related) as unmormal ones, see in output file "unnormal_k_overflow.csv".